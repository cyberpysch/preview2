<div class="card shadow-sm border-0">
    <div class="card-header bg-dark text-white py-2">
        <h6 class="mb-0">Update {{ target_role|upper }}</h6>
    </div>
    <div class="card-body bg-light">
        <form id="editUserForm">
            {% csrf_token %}
            <div class="row g-3 mb-4">
                <div class="col-md-6">
                    <div class="row mb-2 align-items-center">
                        <label class="col-sm-4 small text-danger">* Name</label>
                        <div class="col-sm-8">
                            <input type="text" name="username" class="form-control form-control-sm bg-white"
                                value="{{ target_acc.user.username }}" readonly>
                        </div>
                    </div>
                    <div class="row mb-2 align-items-center">
                        <label class="col-sm-4 small text-danger">* Status</label>
                        <div class="col-sm-8">
                            <select name="is_active" class="form-select form-select-sm">
                                <option value="true" {% if target_acc.is_active %}selected{% endif %}>Active</option>
                                <option value="false" {% if not target_acc.is_active %}selected{% endif %}>Inactive
                                </option>
                            </select>
                        </div>
                    </div>
                    {% if target_role|lower != "client" %}
                    <div class="row mb-2 align-items-center">
                        <label class="col-sm-4 small text-danger">* Share type</label>
                        <div class="col-sm-8">
                            <select name="share_type" class="form-select form-select-sm">
                                <option value="FIXED" {% if target_acc.share_type == "FIXED" %}selected{% endif %}>FIXED
                                </option>
                                <option value="CHANGE" {% if target_acc.share_type == "CHANGE" %}selected{% endif %}>
                                    CHANGE</option>
                            </select>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>

            <h6 class="text-muted small fw-bold border-bottom pb-1 mb-3">Match Share and Comm</h6>
            <div class="row g-4 mb-4">
                <div class="col-md-6 border-end">
                    <div class="row mb-2" data-share-type="{{ parent_acc.share_type }}">
                        <label class="col-sm-5 small text-muted">My Match Share(%)</label>
                        <div class="col-sm-7">
                            <input type="text" name="parent_match_share" id="parent_match_share" data-total="{{ parent_share }}"
                                class="form-control form-control-sm bg-white"
                                value="{{ parent_match_share }}" {% if parent_acc.share_type != "CHANGE" %}readonly{% endif %}>
                            <div class="form-check mt-2">
                                {% if parent_acc.share_type == "CHANGE" %}
                                <input class="form-check-input" type="checkbox" id="toggleShare">
                                <label class="form-check-label small fw-bold" for="toggleShare">
                                    Edit Parent Match Share Instead
                                </label>
                                {% endif %}
                            </div>
                            <small class="text-danger" id = "parent_share">
                                {% if parent_acc.share_type == "FIXED" %}
                                (max share of {{ parent_username }} {{ parent_share }} | Fixed share - cannot be
                                changed)
                                {% else %}
                                (max share of {{ parent_username }} {{ parent_share }})
                                {% endif %}
                            </small>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-muted">My Comm type</label>
                        <div class="col-sm-7"><input type="text" name="parent_comm_type"
                                class="form-control form-control-sm bg-white" readonly></div>
                    </div>
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-muted">My Match Comm(%)</label>
                        <div class="col-sm-7"><input type="text" name="parent_match_comm"
                                class="form-control form-control-sm bg-white" readonly></div>
                    </div>
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-muted">My Sess Comm(%)</label>
                        <div class="col-sm-7"><input type="text" name="parent_sess_comm"
                                class="form-control form-control-sm bg-white" readonly></div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="row mb-2" id="childMatchRow">
    <label class="col-sm-5 small text-danger" style="display:none;">* {{ target_role }} Match Share (%)</label>
    <div class="col-sm-7">
        <input type="number" 
               min="0" 
               step="0.01" 
               name="match_share" 
               id="child_match_Share" 
               value="0.00" 
               class="form-control form-control-sm" 
               readonly>
    </div>
</div>
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-danger">* {{ target_role }} comm type</label>
                        <div class="col-sm-7">
                            <select name="match_comm_type" class="form-select form-select-sm">
                                <option value="bet_by_bet" >Bet by bet</option>
                                <option value="no_commission" >No Commission</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-danger">* {{ target_role }} match comm(%)</label>
                        <div class="col-sm-7"><input type="number" step="0.01" name="match_commission" min="0"
                                value="{{ target_acc.match_commission|default:0 }}"
                                class="form-control form-control-sm"></div>
                    </div>
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-danger">* {{ target_role }} sess comm(%)</label>
                        <div class="col-sm-7"><input type="number" step="0.01" name="session_commission" min="0"
                                value="{{ target_acc.session_commission|default:0 }}"
                                class="form-control form-control-sm"></div>
                    </div>
                </div>
            </div>

            <h6 class="text-muted small fw-bold border-bottom pb-1 mb-3">Casino Share and Comm</h6>
            <div class="row g-4">
                <div class="col-md-6 border-end">
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-muted">My Casino Share(%)</label>
                        <div class="col-sm-7"><input type="text" name="parent_casino_share"
                                value="{{ parent_acc.casino_share|default:0 }}"
                                class="form-control form-control-sm bg-white" readonly></div>
                    </div>
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-muted">My Casino Comm(%)</label>
                        <div class="col-sm-7"><input type="text" name="parent_casino_comm"
                                value="{{ parent_acc.casino_comm|default:0 }}"
                                class="form-control form-control-sm bg-white" readonly></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-danger">* {{ target_role }} casino Share(%)</label>
                        <div class="col-sm-7"><input type="number" min="0" step="0.01" name="casino_share"
                                value="{{ target_acc.casino_share|default:0 }}" class="form-control form-control-sm">
                        </div>
                    </div>
                    <div class="row mb-2">
                        <label class="col-sm-5 small text-danger">* {{ target_role }} casino comm(%)</label>
                        <div class="col-sm-7"><input type="number" min="0" step="0.01" name="casino_commission"
                                value="{{ target_acc.casino_comm|default:0 }}" class="form-control form-control-sm">
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-end mt-4">
                <button type="submit" class="btn btn-primary px-5 btn-sm">Submit Updates</button>
            </div>
        </form>
    </div>
</div>

<style>
    .form-control[readonly] {
        background-color: #e9ecef !important;
        color: #6c757d !important;
        border: 1px solid #ced4da !important;
        cursor: not-allowed;
        box-shadow: none !important;
    }

    .form-control[readonly]:focus {
        outline: none;
        box-shadow: none !important;
        border-color: #ced4da !important;
    }

    #toggleShare {
        cursor: pointer;
    }
</style>